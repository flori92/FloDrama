{"version":3,"file":"PlayPage-3A7GcHwo.js","sources":["../../src/pages/PlayPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { ChevronLeft, Info } from 'lucide-react';\nimport { useMetadata } from '../hooks/useMetadata';\nimport { getVideoUrl } from '../api/metadata';\nimport LoadingSpinner from '../components/ui/LoadingSpinner';\n\n/**\n * Page de lecture vidéo pour FloDrama\n * Permet de lire les épisodes de dramas et les films\n */\nconst PlayPage = () => {\n  const { type, id, episode } = useParams();\n  const { getItemById, isLoading, error } = useMetadata();\n  const [item, setItem] = useState(null);\n  const [videoUrl, setVideoUrl] = useState('');\n  const [isVideoLoading, setIsVideoLoading] = useState(true);\n  const [videoError, setVideoError] = useState(null);\n\n  // Charger les données du contenu\n  useEffect(() => {\n    if (isLoading || error) return;\n    \n    const contentItem = getItemById(id);\n    if (contentItem) {\n      setItem(contentItem);\n      \n      // Déterminer l'URL de la vidéo\n      try {\n        const url = getVideoUrl(contentItem, episode);\n        setVideoUrl(url);\n      } catch (err) {\n        console.error('Erreur lors de la récupération de l\\'URL vidéo:', err);\n        setVideoError('Impossible de charger la vidéo. Veuillez réessayer plus tard.');\n      } finally {\n        setIsVideoLoading(false);\n      }\n    } else {\n      setVideoError('Contenu non trouvé');\n      setIsVideoLoading(false);\n    }\n  }, [id, episode, isLoading, error, getItemById]);\n\n  // Gérer le chargement de la vidéo\n  const handleVideoLoad = () => {\n    setIsVideoLoading(false);\n  };\n\n  // Gérer les erreurs de vidéo\n  const handleVideoError = () => {\n    setIsVideoLoading(false);\n    setVideoError('Erreur lors du chargement de la vidéo. Veuillez réessayer plus tard.');\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className=\"relative min-h-screen bg-black\"\n    >\n      {/* Bouton retour */}\n      <div className=\"absolute top-4 left-4 z-10\">\n        <Link\n          to={`/${type}/${id}`}\n          className=\"flex items-center gap-2 text-white bg-black bg-opacity-50 p-2 rounded-full hover:bg-opacity-70 transition-all\"\n        >\n          <ChevronLeft size={20} />\n          <span className=\"hidden md:inline\">Retour</span>\n        </Link>\n      </div>\n\n      {/* Contenu principal */}\n      <div className=\"w-full h-screen flex flex-col items-center justify-center\">\n        {isLoading || isVideoLoading ? (\n          <div className=\"flex flex-col items-center justify-center\">\n            <LoadingSpinner size=\"large\" />\n            <p className=\"mt-4 text-white\">Chargement de la vidéo...</p>\n          </div>\n        ) : videoError ? (\n          <div className=\"flex flex-col items-center justify-center text-white\">\n            <Info size={48} className=\"text-red-500 mb-4\" />\n            <h2 className=\"text-xl font-bold mb-2\">Erreur de lecture</h2>\n            <p className=\"text-center max-w-md\">{videoError}</p>\n            <Link\n              to={`/${type}/${id}`}\n              className=\"mt-6 px-6 py-2 bg-fuchsia-600 rounded-full hover:bg-fuchsia-700 transition-colors\"\n            >\n              Retour aux détails\n            </Link>\n          </div>\n        ) : (\n          <div className=\"w-full h-full max-w-7xl mx-auto\">\n            {videoUrl && (\n              <video\n                className=\"w-full h-full object-contain\"\n                controls\n                autoPlay\n                src={videoUrl}\n                onLoadedData={handleVideoLoad}\n                onError={handleVideoError}\n              />\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Informations sur le contenu en cours de lecture */}\n      {item && !isVideoLoading && !videoError && (\n        <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-4\">\n          <div className=\"max-w-7xl mx-auto\">\n            <h1 className=\"text-xl md:text-2xl font-bold text-white\">\n              {item.title}\n              {episode && ` - Épisode ${episode}`}\n            </h1>\n            {item.year && (\n              <p className=\"text-gray-300 text-sm\">{item.year}</p>\n            )}\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n};\n\nexport default PlayPage;\n"],"names":["PlayPage","type","id","episode","useParams","getItemById","isLoading","error","useMetadata","item","setItem","useState","videoUrl","setVideoUrl","isVideoLoading","setIsVideoLoading","videoError","setVideoError","useEffect","contentItem","url","getVideoUrl","err","handleVideoLoad","handleVideoError","jsxs","motion","jsx","Link","ChevronLeft","LoadingSpinner","Info"],"mappings":"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"}