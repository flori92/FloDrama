{"version":3,"file":"ContentCard-CG5q9NFE.js","sources":["../../src/components/cards/ContentCard.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Play, Star, Plus, Check, ThumbsUp, ThumbsDown } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { getAssetUrl } from '../../api/metadata';\nimport { useWatchlist } from '../../hooks/useWatchlist';\nimport { useRatings } from '../../hooks/useRatings';\n\n/**\n * Carte de contenu standard pour afficher un drama, film, etc.\n * @param {Object} item - Élément à afficher\n * @param {string} size - Taille de la carte ('sm', 'md', 'lg')\n * @param {number} index - Index pour l'animation en cascade\n */\nconst ContentCard = ({ item, size = 'md', index = 0 }) => {\n  const [showOverlay, setShowOverlay] = useState(false);\n  const [showPreview, setShowPreview] = useState(false);\n  const { isInWatchlist, toggleWatchlist } = useWatchlist();\n  const { isLiked, isDisliked, likeContent, dislikeContent } = useRatings();\n  const [isInList, setIsInList] = useState(false);\n  const [liked, setLiked] = useState(false);\n  const [disliked, setDisliked] = useState(false);\n  const previewTimeoutRef = useRef(null);\n  \n  // Vérifier si l'élément est dans la liste au chargement\n  useEffect(() => {\n    if (item && item.id) {\n      setIsInList(isInWatchlist(item.id));\n      setLiked(isLiked(item.id));\n      setDisliked(isDisliked(item.id));\n    }\n  }, [item, isInWatchlist, isLiked, isDisliked]);\n  \n  // Nettoyer le timeout lors du démontage\n  useEffect(() => {\n    return () => {\n      if (previewTimeoutRef.current) {\n        clearTimeout(previewTimeoutRef.current);\n      }\n    };\n  }, []);\n  \n  if (!item) return null;\n  \n  // Gérer l'ajout/suppression de la liste\n  const handleWatchlistToggle = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    if (item) {\n      const added = toggleWatchlist(item);\n      setIsInList(added);\n    }\n  };\n  \n  // Gérer le like\n  const handleLike = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    if (item) {\n      likeContent(item.id);\n      setLiked(!liked);\n      if (disliked) setDisliked(false);\n    }\n  };\n  \n  // Gérer le dislike\n  const handleDislike = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    if (item) {\n      dislikeContent(item.id);\n      setDisliked(!disliked);\n      if (liked) setLiked(false);\n    }\n  };\n  \n  // Déterminer les classes CSS en fonction de la taille\n  const sizeClasses = {\n    sm: 'w-32 h-48',\n    md: 'w-40 h-60',\n    lg: 'w-48 h-72'\n  };\n  \n  // Déterminer le type de contenu pour la route\n  const getContentType = () => {\n    if (item.section === 'dramas') return 'drama';\n    if (item.section === 'movies') return 'movie';\n    if (item.section === 'bollywood') return 'bollywood';\n    if (item.section === 'anime') return 'anime';\n    return 'drama';\n  };\n\n  // Gérer l'entrée de la souris\n  const handleMouseEnter = () => {\n    setShowOverlay(true);\n    \n    // Afficher la prévisualisation après un court délai\n    previewTimeoutRef.current = setTimeout(() => {\n      setShowPreview(true);\n    }, 500);\n  };\n  \n  // Gérer la sortie de la souris\n  const handleMouseLeave = () => {\n    setShowOverlay(false);\n    setShowPreview(false);\n    \n    // Nettoyer le timeout\n    if (previewTimeoutRef.current) {\n      clearTimeout(previewTimeoutRef.current);\n      previewTimeoutRef.current = null;\n    }\n  };\n\n  // Animations pour la carte\n  const cardVariants = {\n    hidden: { \n      opacity: 0,\n      y: 20,\n    },\n    visible: { \n      opacity: 1,\n      y: 0,\n      transition: { \n        duration: 0.5,\n        delay: index * 0.05,\n        ease: \"easeOut\"\n      }\n    },\n    hover: { \n      scale: 1.05,\n      transition: { \n        duration: 0.3,\n        ease: \"easeInOut\"\n      }\n    }\n  };\n  \n  // Animation pour la prévisualisation\n  const previewVariants = {\n    hidden: { opacity: 0, y: 10 },\n    visible: { \n      opacity: 1, \n      y: 0,\n      transition: { duration: 0.3 }\n    }\n  };\n  \n  return (\n    <motion.div\n      initial=\"hidden\"\n      animate=\"visible\"\n      whileHover=\"hover\"\n      variants={cardVariants}\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n      className=\"relative\"\n    >\n      <Link \n        to={`/${getContentType()}/${item.id}`}\n        className=\"group cursor-pointer block\"\n      >\n        <div className={`relative overflow-hidden rounded-lg mb-2 ${sizeClasses[size] || sizeClasses.md}`}>\n          <img \n            src={getAssetUrl(item.poster)} \n            alt={item.title}\n            className=\"w-full h-full object-cover\"\n            loading=\"lazy\"\n          />\n          \n          {/* Overlay au survol avec animation */}\n          <AnimatePresence>\n            {showOverlay && (\n              <motion.div \n                className=\"absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent flex flex-col justify-end p-3\"\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                transition={{ duration: 0.2 }}\n              >\n                {/* Titre et boutons */}\n                <div className=\"flex justify-between items-end\">\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-sm font-bold truncate\">{item.title}</h3>\n                    {item.year && (\n                      <p className=\"text-xs text-gray-300\">{item.year}</p>\n                    )}\n                  </div>\n                  <div className=\"flex space-x-1\">\n                    <button \n                      className={`p-1.5 rounded-full ${isInList ? 'bg-fuchsia-600 text-white' : 'bg-white/20 text-white hover:bg-white/30'}`}\n                      onClick={handleWatchlistToggle}\n                      aria-label={isInList ? \"Retirer de ma liste\" : \"Ajouter à ma liste\"}\n                    >\n                      {isInList ? <Check size={14} /> : <Plus size={14} />}\n                    </button>\n                    <button \n                      className=\"p-1.5 rounded-full bg-fuchsia-600 text-white\"\n                      aria-label=\"Lire\"\n                    >\n                      <Play size={14} fill=\"white\" />\n                    </button>\n                  </div>\n                </div>\n                \n                {/* Prévisualisation avec animation */}\n                <AnimatePresence>\n                  {showPreview && (\n                    <motion.div \n                      className=\"mt-2\"\n                      variants={previewVariants}\n                      initial=\"hidden\"\n                      animate=\"visible\"\n                      exit=\"hidden\"\n                    >\n                      {/* Informations supplémentaires */}\n                      <div className=\"flex items-center text-xs space-x-2 mb-1\">\n                        {item.rating && (\n                          <div className=\"flex items-center\">\n                            <Star size={12} className=\"text-yellow-400 mr-0.5\" />\n                            <span>{item.rating}</span>\n                          </div>\n                        )}\n                        {item.duration && (\n                          <span>{item.duration}</span>\n                        )}\n                        {item.year && (\n                          <span>{item.year}</span>\n                        )}\n                      </div>\n                      \n                      {/* Genres */}\n                      {item.categories && item.categories.length > 0 && (\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\n                          {item.categories.slice(0, 2).map((genre, idx) => (\n                            <span \n                              key={idx} \n                              className=\"text-[10px] bg-white/20 px-1.5 py-0.5 rounded\"\n                            >\n                              {genre}\n                            </span>\n                          ))}\n                        </div>\n                      )}\n                      \n                      {/* Description tronquée */}\n                      {item.description && (\n                        <p className=\"text-xs text-gray-300 mt-1 line-clamp-2\">\n                          {item.description}\n                        </p>\n                      )}\n                      \n                      {/* Actions */}\n                      <div className=\"flex justify-between mt-2\">\n                        <div className=\"flex space-x-2\">\n                          <button \n                            className={`p-1 ${liked ? 'text-green-400' : 'text-gray-400 hover:text-white'}`}\n                            onClick={handleLike}\n                            aria-label=\"J'aime\"\n                          >\n                            <ThumbsUp size={14} />\n                          </button>\n                          <button \n                            className={`p-1 ${disliked ? 'text-red-400' : 'text-gray-400 hover:text-white'}`}\n                            onClick={handleDislike}\n                            aria-label=\"Je n'aime pas\"\n                          >\n                            <ThumbsDown size={14} />\n                          </button>\n                        </div>\n                      </div>\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </motion.div>\n            )}\n          </AnimatePresence>\n          \n          {/* Badge de notation (toujours visible) */}\n          {item.rating && (\n            <div className=\"absolute top-2 right-2 bg-red-600 text-white text-xs font-bold px-1.5 py-0.5 rounded flex items-center\">\n              <Star size={12} className=\"mr-0.5\" />\n              {item.rating}\n            </div>\n          )}\n          \n          {/* Badge d'épisodes (toujours visible) */}\n          {item.episodes && (\n            <div className=\"absolute bottom-2 left-2 bg-black bg-opacity-70 text-white text-xs px-1.5 py-0.5 rounded\">\n              {item.latest_episode}/{item.episodes} EP\n            </div>\n          )}\n        </div>\n        \n        {/* Informations textuelles (toujours visibles) */}\n        <h3 className=\"font-medium text-sm truncate\">{item.title}</h3>\n        <div className=\"flex text-xs text-gray-400 space-x-2\">\n          <span>{item.year}</span>\n          {item.categories && item.categories.length > 0 && (\n            <>\n              <span>•</span>\n              <span>{item.categories[0]}</span>\n            </>\n          )}\n        </div>\n      </Link>\n    </motion.div>\n  );\n};\n\nexport default ContentCard;\n"],"names":["ContentCard","item","size","index","showOverlay","setShowOverlay","useState","showPreview","setShowPreview","isInWatchlist","toggleWatchlist","useWatchlist","isLiked","isDisliked","likeContent","dislikeContent","useRatings","isInList","setIsInList","liked","setLiked","disliked","setDisliked","previewTimeoutRef","useRef","useEffect","handleWatchlistToggle","e","added","handleLike","handleDislike","sizeClasses","getContentType","handleMouseEnter","handleMouseLeave","cardVariants","previewVariants","jsx","motion","jsxs","Link","getAssetUrl","AnimatePresence","Check","Plus","Play","Star","genre","idx","ThumbsUp","ThumbsDown","Fragment"],"mappings":"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"}