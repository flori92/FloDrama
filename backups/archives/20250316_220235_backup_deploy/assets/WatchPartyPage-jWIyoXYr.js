import{j as e,s as D,B as u,b as w,e as d,i as y,S as E,k as W,l as A}from"./ui-components-DqEG6yq2.js";import{u as B,e as I,a as t}from"./vendor-Chun8WN8.js";import{u as L,W as T,c as z}from"./watch-party-DrKsmoI2.js";import{u as M}from"./auth-CvLoGRuB.js";import"react-native-gifted-chat";const b=D(A)(({theme:s})=>({paddingTop:s.spacing(3),paddingBottom:s.spacing(3),height:"100vh",display:"flex",flexDirection:"column"})),N=()=>{const{partyId:s,dramaId:a}=B(),r=I(),{user:v,isAuthenticated:h}=M(),{hasActiveSubscription:n,currentPlan:m}=L(),[i,o]=t.useState(!0),[p,x]=t.useState(null),[S,f]=t.useState(!1),[j,k]=t.useState(""),[C,P]=t.useState("info");t.useEffect(()=>{h&&!i&&(!n||m!=="ultimate")&&x("La fonctionnalité Watch Party est disponible uniquement pour les abonnements Ultimate.")},[h,n,m,i]),t.useEffect(()=>{a&&s&&(async()=>{try{o(!0),setTimeout(()=>{o(!1)},1500)}catch(l){console.error("Erreur lors du chargement des détails du drama:",l),x("Impossible de charger les détails du drama. Veuillez réessayer."),o(!1)}})()},[a,s,v]);const g=(c,l)=>{l!=="clickaway"&&f(!1)};return i?e.jsx(b,{children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"70vh"},children:[e.jsx(w,{size:60}),e.jsx(d,{variant:"h6",sx:{mt:3},children:"Préparation de la Watch Party..."})]})}):p?e.jsx(b,{children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"70vh"},children:[e.jsx(d,{variant:"h5",color:"error",gutterBottom:!0,children:"Oups ! Un problème est survenu"}),e.jsx(d,{variant:"body1",sx:{mb:3,textAlign:"center"},children:p}),!n&&e.jsx(y,{variant:"contained",color:"primary",onClick:()=>r("/subscription"),sx:{mt:2},children:"Découvrir les abonnements"}),e.jsx(y,{variant:"outlined",onClick:()=>r(-1),sx:{mt:2},children:"Retour"})]})}):e.jsxs(u,{sx:{height:"100vh",overflow:"hidden"},children:[e.jsx(T,{partyId:s,dramaId:a,onShareSuccess:c=>{z(c),k("Lien de la Watch Party copié dans le presse-papiers !"),P("success"),f(!0)},onLeave:()=>r(`/watch/${a}`)}),e.jsx(E,{open:S,autoHideDuration:6e3,onClose:g,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(W,{onClose:g,severity:C,sx:{width:"100%"},children:j})})]})};export{N as default};
//# sourceMappingURL=WatchPartyPage-jWIyoXYr.js.map
