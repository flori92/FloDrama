import{c as j,j as e,s as m,B as r,e as n,S as _,k as ee,b as z,i as h,D as P,G as b,C as D,m as k,n as te,o as ie,p as ne,T as f,q as se,r as ae,t as re,l as oe,u as le,v as ce,w as de,x as ue}from"./ui-components-DqEG6yq2.js";import{a,e as he}from"./vendor-Chun8WN8.js";import{u as me,w as xe}from"./watch-party-DrKsmoI2.js";import"./auth-CvLoGRuB.js";import"react-native-gifted-chat";const w=j(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),pe=j(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"Group"),L=j(e.jsx("path",{d:"M21 6h-7.59l3.29-3.29L16 2l-4 4-4-4-.71.71L10.59 6H3c-1.1 0-2 .89-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.11-.9-2-2-2m0 14H3V8h18zM9 10v8l7-4z"}),"LiveTv"),V=j(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock"),M=j(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"}),"Public"),ve=a.createContext(),ge=()=>a.useContext(ve),je=m(oe)(({theme:i})=>({paddingTop:i.spacing(4),paddingBottom:i.spacing(8)})),N=m(le)(({theme:i})=>({height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s","&:hover":{transform:"translateY(-5px)",boxShadow:i.shadows[8]}})),G=m(ce)(({theme:i})=>({paddingTop:"56.25%",position:"relative"})),B=m(r)(({theme:i})=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.7) 100%)",display:"flex",flexDirection:"column",justifyContent:"flex-end",padding:i.spacing(2),color:"white"})),E=m(de)(({theme:i})=>({flexGrow:1})),be=m(ue)(({theme:i})=>({position:"fixed",bottom:i.spacing(4),right:i.spacing(4)})),F=m(D)(({theme:i,status:x})=>{let l=i.palette.primary.main;return x==="live"?l=i.palette.success.main:x==="scheduled"?l=i.palette.warning.main:x==="ended"&&(l=i.palette.error.main),{backgroundColor:l,color:"white",fontWeight:"bold"}}),Ie=()=>{const[i,x]=a.useState([]),[l,o]=a.useState(!0),[I,p]=a.useState(null),[H,v]=a.useState(!1),[s,T]=a.useState({title:"",description:"",contentId:"",isPrivate:!1,scheduledTime:""}),y=he(),{user:c}=ge(),{hasActiveSubscription:C,currentPlan:W}=me(),[O,S]=a.useState(!1),[q,U]=a.useState(""),[R,Y]=a.useState("info"),K=a.useMemo(()=>xe,[]);a.useEffect(()=>{c&&(async()=>{try{if(o(!0),!C||W!=="ultimate"){p("La fonctionnalité Watch Party est disponible uniquement pour les abonnements Ultimate."),o(!1);return}setTimeout(()=>{x([{id:"wp1",title:"Soirée K-Drama",contentId:"drama123",contentTitle:"Crash Landing on You",contentThumbnail:"https://via.placeholder.com/300x200?text=Drama+Thumbnail",hostId:"user1",hostName:"Sophie",participantCount:5,isPrivate:!1,status:"active",createdAt:new Date(Date.now()-36e5).toISOString()},{id:"wp2",title:"Marathon Goblin",contentId:"drama456",contentTitle:"Goblin",contentThumbnail:"https://via.placeholder.com/300x200?text=Goblin",hostId:"user2",hostName:"Thomas",participantCount:3,isPrivate:!0,status:"active",createdAt:new Date(Date.now()-72e5).toISOString()}]),o(!1)},1500)}catch(u){console.error("Erreur lors du chargement des soirées de visionnage:",u),p("Impossible de charger les soirées de visionnage. Veuillez réessayer."),o(!1)}})()},[c,C,W]);const $=async()=>{try{if(o(!0),!s.title||!s.contentId){p("Veuillez remplir tous les champs obligatoires");return}const t=await K.createWatchParty({title:s.title,description:s.description,contentId:s.contentId,isPrivate:s.isPrivate,scheduledTime:s.scheduledTime?new Date(s.scheduledTime):null});v(!1),T({title:"",description:"",contentId:"",isPrivate:!1,scheduledTime:""}),U("Soirée de visionnage créée avec succès !"),Y("success"),S(!0),y(`/watch-party/${t.id}`)}catch(t){console.error("Erreur lors de la création de la soirée de visionnage:",t),p("Impossible de créer la soirée de visionnage")}finally{o(!1)}},A=t=>{y(`/watch-party/${t}`)},g=t=>{const{name:u,value:Q,checked:X}=t.target;T(Z=>({...Z,[u]:u==="isPrivate"?X:Q}))},J=t=>new Date(t).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),d=t=>t.endedAt?{label:"Terminée",value:"ended"}:t.startedAt?{label:"En direct",value:"live"}:t.scheduledTime&&new Date(t.scheduledTime)>new Date?{label:"Programmée",value:"scheduled"}:{label:"En attente",value:"pending"};return e.jsxs(je,{maxWidth:"lg",children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,children:[e.jsx(n,{variant:"h4",component:"h1",gutterBottom:!0,children:"Soirées de Visionnage"}),e.jsxs(r,{display:"flex",alignItems:"center",children:[c&&e.jsxs(n,{variant:"h6",sx:{mb:2},children:["Bienvenue, ",c.displayName||c.email||"Utilisateur"]}),e.jsx(_,{open:O,autoHideDuration:6e3,onClose:()=>S(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ee,{onClose:()=>S(!1),severity:R,sx:{width:"100%"},children:q})})]})]}),l&&!i.length?e.jsx(r,{display:"flex",justifyContent:"center",my:8,children:e.jsx(z,{})}):I?e.jsxs(r,{textAlign:"center",my:4,children:[e.jsx(n,{variant:"h6",color:"error",gutterBottom:!0,children:I}),!C&&e.jsx(h,{variant:"contained",color:"primary",onClick:()=>y("/subscription"),sx:{mt:2,mr:2},children:"Découvrir les abonnements Ultimate"}),e.jsx(h,{variant:"outlined",onClick:()=>{p(null),o(!0),(async()=>{try{setTimeout(()=>{x([{id:"wp1",title:"Soirée K-Drama",contentId:"drama123",contentTitle:"Crash Landing on You",contentThumbnail:"https://via.placeholder.com/300x200?text=Drama+Thumbnail",hostId:"user1",hostName:"Sophie",participantCount:5,isPrivate:!1,status:"active",createdAt:new Date(Date.now()-36e5).toISOString()},{id:"wp2",title:"Marathon Goblin",contentId:"drama456",contentTitle:"Goblin",contentThumbnail:"https://via.placeholder.com/300x200?text=Goblin",hostId:"user2",hostName:"Thomas",participantCount:3,isPrivate:!0,status:"active",createdAt:new Date(Date.now()-72e5).toISOString()}]),o(!1)},1500)}catch(u){console.error("Erreur lors du chargement des soirées de visionnage:",u),p("Impossible de charger les soirées de visionnage. Veuillez réessayer."),o(!1)}})()},sx:{mt:2},children:"Réessayer"})]}):i.length===0?e.jsxs(r,{textAlign:"center",my:8,children:[e.jsx(L,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"Aucune soirée de visionnage disponible"}),e.jsx(n,{variant:"body1",color:"textSecondary",paragraph:!0,children:c?"Créez votre première soirée pour regarder des contenus avec vos amis !":"Connectez-vous pour créer ou rejoindre des soirées de visionnage."}),e.jsx(h,{variant:"contained",color:"primary",startIcon:e.jsx(w,{}),onClick:()=>v(!0),disabled:!c,children:"Créer une soirée"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(r,{mb:4,children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Soirées en direct"}),e.jsx(P,{sx:{mb:2}}),e.jsx(b,{container:!0,spacing:3,children:i.filter(t=>d(t).value==="live").map(t=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(N,{children:[e.jsx(G,{image:t.thumbnailUrl||"https://via.placeholder.com/300x169?text=FloDrama",title:t.title,children:e.jsxs(B,{children:[e.jsx(F,{label:d(t).label,status:d(t).value,size:"small",icon:e.jsx(L,{})}),e.jsx(n,{variant:"h6",component:"div",children:t.title})]})}),e.jsxs(E,{children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(n,{variant:"body2",color:"textSecondary",children:["Hôte: ",t.hostName]}),e.jsx(D,{icon:t.isPrivate?e.jsx(V,{}):e.jsx(M,{}),label:t.isPrivate?"Privée":"Publique",size:"small",variant:"outlined"})]}),e.jsx(n,{variant:"body2",paragraph:!0,children:t.description||"Aucune description"}),e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action"}),e.jsxs(n,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:[t.participantCount||0," participants"]})]})]}),e.jsx(k,{children:e.jsx(h,{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>A(t.id),children:"Rejoindre"})})]})},t.id))}),!i.some(t=>d(t).value==="live")&&e.jsx(n,{variant:"body2",color:"textSecondary",align:"center",sx:{my:3},children:"Aucune soirée en direct pour le moment"})]}),e.jsxs(r,{mb:4,children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Soirées programmées"}),e.jsx(P,{sx:{mb:2}}),e.jsx(b,{container:!0,spacing:3,children:i.filter(t=>d(t).value==="scheduled").map(t=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(N,{children:[e.jsx(G,{image:t.thumbnailUrl||"https://via.placeholder.com/300x169?text=FloDrama",title:t.title,children:e.jsxs(B,{children:[e.jsx(F,{label:d(t).label,status:d(t).value,size:"small"}),e.jsx(n,{variant:"h6",component:"div",children:t.title})]})}),e.jsxs(E,{children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(n,{variant:"body2",color:"textSecondary",children:["Hôte: ",t.hostName]}),e.jsx(D,{icon:t.isPrivate?e.jsx(V,{}):e.jsx(M,{}),label:t.isPrivate?"Privée":"Publique",size:"small",variant:"outlined"})]}),e.jsx(n,{variant:"body2",paragraph:!0,children:t.description||"Aucune description"}),e.jsxs(n,{variant:"body2",color:"primary",fontWeight:"bold",children:["Date: ",J(t.scheduledTime)]})]}),e.jsx(k,{children:e.jsx(h,{fullWidth:!0,variant:"outlined",color:"primary",onClick:()=>A(t.id),children:"Détails"})})]})},t.id))}),!i.some(t=>d(t).value==="scheduled")&&e.jsx(n,{variant:"body2",color:"textSecondary",align:"center",sx:{my:3},children:"Aucune soirée programmée pour le moment"})]})]}),e.jsx(be,{color:"primary","aria-label":"Créer une soirée de visionnage",onClick:()=>v(!0),disabled:!c,children:e.jsx(w,{})}),e.jsxs(te,{open:H,onClose:()=>v(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Créer une nouvelle soirée de visionnage"}),e.jsxs(ne,{children:[e.jsx(f,{autoFocus:!0,margin:"dense",name:"title",label:"Titre de la soirée *",type:"text",fullWidth:!0,variant:"outlined",value:s.title,onChange:g,sx:{mb:2}}),e.jsx(f,{margin:"dense",name:"description",label:"Description",type:"text",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,value:s.description,onChange:g,sx:{mb:2}}),e.jsx(f,{margin:"dense",name:"contentId",label:"ID du contenu à regarder *",type:"text",fullWidth:!0,variant:"outlined",value:s.contentId,onChange:g,sx:{mb:2},helperText:"Entrez l'ID du drama, film ou série que vous souhaitez regarder"}),e.jsx(f,{margin:"dense",name:"scheduledTime",label:"Date et heure programmées",type:"datetime-local",fullWidth:!0,variant:"outlined",InputLabelProps:{shrink:!0},value:s.scheduledTime,onChange:g,sx:{mb:2}}),e.jsx(se,{control:e.jsx(ae,{checked:s.isPrivate,onChange:g,name:"isPrivate",color:"primary"}),label:"Soirée privée (accessible uniquement sur invitation)"})]}),e.jsxs(re,{children:[e.jsx(h,{onClick:()=>v(!1),children:"Annuler"}),e.jsx(h,{onClick:$,variant:"contained",color:"primary",disabled:l||!s.title||!s.contentId,children:l?e.jsx(z,{size:24}):"Créer"})]})]})]})};export{Ie as default};
//# sourceMappingURL=WatchPartyListPage-DWtFeikW.js.map
