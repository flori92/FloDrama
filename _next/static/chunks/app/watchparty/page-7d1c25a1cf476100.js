(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[338],{1746:(t,e,n)=>{Promise.resolve().then(n.bind(n,3971))},3971:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var i=n(5155),a=n(2115),r=n(4564);function s(){let[t,e]=(0,a.useState)([]),[n,s]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{s(!0);try{let t=(0,r.d2)("watchparty",{limit:24});e(t),o(null)}catch(t){o("Erreur lors du chargement des watchparties ou fonctionnalit\xe9 non disponible."),e([])}finally{s(!1)}},[]),(0,i.jsxs)("main",{className:"p-8",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"WatchParty"}),n&&(0,i.jsx)("p",{children:"Chargement des watchparties..."}),c&&(0,i.jsx)("p",{className:"text-red-500",children:c}),!n&&!c&&0===t.length&&(0,i.jsx)("p",{children:"Aucune watchparty trouv\xe9e ou fonctionnalit\xe9 \xe0 venir."}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:t.map(t=>(0,i.jsxs)("div",{className:"bg-white rounded shadow p-2 flex flex-col items-center",children:[t.imageUrl&&(0,i.jsx)("img",{src:t.imageUrl,alt:t.title,className:"w-full h-48 object-cover rounded mb-2",loading:"lazy"}),(0,i.jsx)("h2",{className:"font-semibold text-lg text-center truncate w-full",title:t.title,children:t.title}),t.year&&(0,i.jsx)("span",{className:"text-gray-500 text-sm",children:t.year}),t.rating&&(0,i.jsxs)("span",{className:"text-yellow-600 text-xs mt-1",children:["â­ ",t.rating]})]},t.id))})]})}},4564:(t,e,n)=>{"use strict";n.d(e,{cG:()=>o,fk:()=>l,d2:()=>u,EK:()=>c});let i={DEBUG:!0,CONTENT_FILE_PATH:"/data/content.json"},a={info:function(t){console.info("[FloDrama SmartScrapingService] ".concat(t))},warn:function(t){console.warn("[FloDrama SmartScrapingService] ".concat(t))},error:function(t,e){console.error("[FloDrama SmartScrapingService] ".concat(t),e)},debug:function(t){i.DEBUG&&console.debug("[FloDrama SmartScrapingService] ".concat(t))},table:function(t){console.table(t)}};class r{async initialize(){if(this.isInitialized)return void a.warn("Le service est d\xe9j\xe0 initialis\xe9");a.info("Initialisation du service de scraping intelligent...");try{await this.loadContentCache(),this.updateStats(),this.isInitialized=!0,a.info("Service initialis\xe9 avec succ\xe8s");{let t=new CustomEvent("initialized",{detail:this.stats});this.events.dispatchEvent(t)}}catch(t){throw a.error("Erreur lors de l'initialisation du service",t),t}}async loadContentCache(){a.debug("Chargement du cache de contenu...");try{let t=await fetch(i.CONTENT_FILE_PATH);if(!t.ok)throw Error("Impossible de charger le fichier de contenu: ".concat(t.status));let e=await t.json();if(!e.items||!Array.isArray(e.items))throw Error("Structure de donn\xe9es invalide");this.contentCache=e,a.info("Cache de contenu charg\xe9 avec ".concat(e.items.length," \xe9l\xe9ments"))}catch(t){throw a.error("Erreur lors du chargement du cache de contenu",t),this.contentCache={lastUpdate:new Date().toISOString(),contentIds:[],items:[]},t}}updateStats(){if(!this.contentCache)return;let t=this.contentCache.items;this.stats={totalItems:t.length,itemsByCategory:{},itemsBySource:{},lastUpdate:this.contentCache.lastUpdate},t.forEach(t=>{let e=t.type||"unknown",n=t.source||"unknown";this.stats.itemsByCategory[e]||(this.stats.itemsByCategory[e]=0),this.stats.itemsBySource[n]||(this.stats.itemsBySource[n]=0),this.stats.itemsByCategory[e]++,this.stats.itemsBySource[n]++}),a.debug("Statistiques mises \xe0 jour"),a.table(this.stats)}getCategoryItems(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.contentCache)return[];let{limit:n=20,offset:i=0,sort:a="recent",filter:r={}}=e,s=this.contentCache.items.filter(e=>{if("all"!==t&&e.type!==t)return!1;for(let[t,n]of Object.entries(r))if(Array.isArray(e[t])){if(!e[t].includes(n))return!1}else if(e[t]!==n)return!1;return!0});return"recent"===a?s.sort((t,e)=>{let n=new Date(t.releaseDate?t.releaseDate:0);return new Date(e.releaseDate?e.releaseDate:0)-n}):"popular"===a?s.sort((t,e)=>(e.popularity||0)-(t.popularity||0)):"rating"===a&&s.sort((t,e)=>(e.rating||0)-(t.rating||0)),s.slice(i,i+n)}async searchContent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.info('Recherche de contenu pour "'.concat(t,'"...')),this.contentCache||await this.loadContentCache();let{limit:n=20,category:i="all",fuzzy:r=!0}=e,s=t.toLowerCase().trim(),c=this.contentCache.items;"all"!==i&&(c=c.filter(t=>t.type===i));let o=c.filter(t=>{let e=(t.title||"").toLowerCase(),n=(t.originalTitle||"").toLowerCase(),i=(t.description||"").toLowerCase();return r?e.includes(s)||n.includes(s)||i.includes(s):e===s||n===s}).slice(0,n);if(a.info("".concat(o.length,' r\xe9sultats trouv\xe9s pour "').concat(t,'"')),0===o.length&&void 0!==window.SmartScrapingServiceOriginal){a.info('Aucun r\xe9sultat trouv\xe9 localement, recherche en ligne pour "'.concat(t,'"...'));try{let n=await window.SmartScrapingServiceOriginal.searchContent(t,e);if(n&&n.length>0)return a.info("".concat(n.length,' r\xe9sultats trouv\xe9s en ligne pour "').concat(t,'"')),this.contentCache.items.push(...n),this.updateStats(),n}catch(e){a.error('Erreur lors de la recherche en ligne pour "'.concat(t,'"'),e)}}return o}async getContentDetails(t){a.info("R\xe9cup\xe9ration des d\xe9tails pour le contenu ".concat(t)),this.contentCache||await this.loadContentCache();let e=this.contentCache.items.find(e=>e.id===t);if(e)return a.info("D\xe9tails trouv\xe9s pour le contenu ".concat(t)),e;if(void 0!==window.SmartScrapingServiceOriginal){a.info("Contenu ".concat(t," non trouv\xe9 localement, recherche en ligne..."));try{let e=await window.SmartScrapingServiceOriginal.getContentDetails(t);if(e)return a.info("D\xe9tails trouv\xe9s en ligne pour le contenu ".concat(t)),this.contentCache.items.push(e),this.updateStats(),e}catch(e){a.error("Erreur lors de la r\xe9cup\xe9ration des d\xe9tails en ligne pour le contenu ".concat(t),e)}}return a.warn("Aucun d\xe9tail trouv\xe9 pour le contenu ".concat(t)),null}constructor(){this.events=document.createDocumentFragment(),this.events.__proto__=EventTarget.prototype,this.contentCache=null,this.isInitialized=!1,this.isUpdating=!1,this.stats={totalItems:0,itemsByCategory:{},itemsBySource:{},lastUpdate:null},a.info("SmartScrapingServiceAdapter initialis\xe9")}}let s=new r;{s.initialize().catch(t=>{a.error("Erreur lors de l'initialisation du service",t)}),window.SmartScrapingService=s;let t=Object.defineProperty;Object.defineProperty=function(e,n,i){return e===window&&"SmartScrapingService"===n&&i.value!==s&&(window.SmartScrapingServiceOriginal=i.value,i.value=s,a.info("SmartScrapingService original d\xe9tect\xe9 et sauvegard\xe9")),t.call(this,e,n,i)}}async function c(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return await h(),s.getCategoryItems("movie",{limit:t})}async function o(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return await h(),s.getCategoryItems("anime",{limit:t})}async function l(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return await h(),s.getCategoryItems("bollywood",{limit:t})}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.getCategoryItems(t,e)}async function h(){s.isInitialized||await s.initialize()}}},t=>{var e=e=>t(t.s=e);t.O(0,[441,684,358],()=>e(1746)),_N_E=t.O()}]);