<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Vidéo FloDrama - URL Pré-signées</title>
    <style>
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #121118;
            color: white;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            background: linear-gradient(to right, #3b82f6, #d946ef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
        }
        .video-container {
            margin-bottom: 20px;
        }
        video {
            width: 100%;
            border-radius: 8px;
            background-color: #000;
        }
        h2 {
            margin-top: 30px;
        }
        .quality-selector {
            margin-bottom: 20px;
        }
        select {
            background-color: #1A1926;
            color: white;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #3b82f6;
        }
        button {
            background: linear-gradient(to right, #3b82f6, #d946ef);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .note {
            margin-top: 30px;
            padding: 15px;
            background-color: #1A1926;
            border-radius: 8px;
            border-left: 4px solid #d946ef;
        }
    </style>
</head>
<body>
    <h1>Test Vidéo FloDrama - URL Pré-signées</h1>
    
    <div class="quality-selector">
        <select id="qualitySelect">
            <option value="0">240p</option>
            <option value="1">360p</option>
            <option value="2">480p</option>
            <option value="3" selected>720p</option>
            <option value="4">1080p</option>
        </select>
        <button id="loadButton">Charger la vidéo</button>
    </div>
    
    <div class="video-container">
        <h2 id="videoTitle">Vidéo 720p</h2>
        <video id="videoPlayer" controls></video>
    </div>
    
    <div class="note">
        <p><strong>Note:</strong> Les URL pré-signées sont valides pendant 24 heures à partir de la génération (86400 secondes).</p>
        <p>Date de génération: <span id="generationDate"></span></p>
        <p>Date d'expiration: <span id="expirationDate"></span></p>
    </div>
    
    <script>
        // URLs pré-signées générées par le script
        const presignedUrls = [
            "https://flodrama-video-cache.s3.us-east-1.amazonaws.com/test/test-video-240p.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARSU7KZ3YZRFUPPHH%2F20250409%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250409T183914Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=3c82c5e97479afa22badf2d4ee4b11ac62e1669db43e1cf24a72906e16a13377",
            "https://flodrama-video-cache.s3.us-east-1.amazonaws.com/test/test-video-360p.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARSU7KZ3YZRFUPPHH%2F20250409%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250409T183914Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=25b81a8aa3ad60c4076883ce04da90b1d6e577a85acd799708ce505e4d48ad8a",
            "https://flodrama-video-cache.s3.us-east-1.amazonaws.com/test/test-video-480p.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARSU7KZ3YZRFUPPHH%2F20250409%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250409T183914Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=f77c83531c7dfd346d9e1c9df5dd6de2f5a2e7620ae4a6552d87161bdfc1a658",
            "https://flodrama-video-cache.s3.us-east-1.amazonaws.com/test/test-video-720p.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARSU7KZ3YZRFUPPHH%2F20250409%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250409T183915Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=e6e01611bec012c411aed509a9207dbb6190c7171ba56faa0965be5eee5142a5",
            "https://flodrama-video-cache.s3.us-east-1.amazonaws.com/test/test-video-1080p.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARSU7KZ3YZRFUPPHH%2F20250409%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250409T183915Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=0c306bbbbe267b5f4d4183c9566cdaef708c4485cc353dde0d0e7cfc3d13813e"
        ];
        
        // Qualités correspondantes
        const qualities = ["240p", "360p", "480p", "720p", "1080p"];
        
        // Éléments DOM
        const qualitySelect = document.getElementById('qualitySelect');
        const loadButton = document.getElementById('loadButton');
        const videoTitle = document.getElementById('videoTitle');
        const videoPlayer = document.getElementById('videoPlayer');
        const generationDate = document.getElementById('generationDate');
        const expirationDate = document.getElementById('expirationDate');
        
        // Dates de génération et d'expiration
        const now = new Date();
        const expiration = new Date(now.getTime() + 86400 * 1000);
        generationDate.textContent = now.toLocaleString();
        expirationDate.textContent = expiration.toLocaleString();
        
        // Fonction pour charger la vidéo sélectionnée
        function loadVideo() {
            const selectedIndex = parseInt(qualitySelect.value);
            const selectedQuality = qualities[selectedIndex];
            const selectedUrl = presignedUrls[selectedIndex];
            
            videoTitle.textContent = `Vidéo ${selectedQuality}`;
            videoPlayer.src = selectedUrl;
            videoPlayer.load();
        }
        
        // Événements
        loadButton.addEventListener('click', loadVideo);
        
        // Charger la vidéo 720p par défaut
        qualitySelect.value = "3"; // 720p
        loadVideo();
    </script>
</body>
</html>
